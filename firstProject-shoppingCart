import React from "react";
import { createRoot } from "react-dom/client";
import Items from "./data.jsx";

let rootElement = document.getElementById("root");
let root = createRoot(rootElement);

function Display() {
  // ğŸ›’ cart state
  let [cart, setCart] = React.useState([]);
  // ğŸŒ track which page we are on: "home" or "cart"
  let [page, setPage] = React.useState("home");

  // Sort items by discount
  let sortedItems = [...Items].sort(
    (a, b) => parseInt(b.discount) - parseInt(a.discount)
  );

  // Add item to cart
  function handleClick(item) {
    alert(`${item.name} added to cart`);
    setCart((prevCart) => [...prevCart, item]);
  }

  // Navigate to cart page
  function handleCart() {
    setPage("cart");
  }

  // Navigate back to main page
  function handleBack() {
    setPage("home");
  }

  // ğŸ  Main Page
  if (page === "home") {
    return (
      <div className="container">
        {sortedItems.map((item, index) => (
          <div className="items" key={index}>
            {parseInt(item.discount) > 10 && <p className="top">ğŸ”¥ Top Sale</p>}
            <p>Item name: {item.name}</p>
            <p>Item Price: â‚¹{item.price}</p>
            {parseInt(item.discount) !== 0 && (
              <p>Item Discount: {item.discount}</p>
            )}
            <button className="btn" onClick={() => handleClick(item)}>
              Add to cart
            </button>
          </div>
        ))}

        <button className="btn" onClick={handleCart}>
          ğŸ›’ Go to Cart ({cart.length})
        </button>
      </div>
    );
  }

  // ğŸ›’ Cart Page
  else if (page === "cart") {
    return (
      <div className="cart-page">
        <h2>Your Cart</h2>

        {cart.length === 0 ? (
          <p>Your cart is empty!</p>
        ) : (
          <ul>
            {cart.map((item, index) => (
              <li key={index}>
                {item.name} â€” â‚¹{item.price} ({item.discount} off)
              </li>
            ))}
          </ul>
        )}

        <button className="btn" onClick={handleBack}>
          ğŸ”™ Back to Main Page
        </button>
      </div>
    );
  }
}

root.render(
  <>
    <h1>Welcome to HiMart</h1>
    <Display />
  </>
);
